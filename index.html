<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Sheet Học Tập - mokhoatrithuc.io.vn/</title>
  <meta name="description" content="Sheet học tập,khóa xps 2k8 nơi học tập chính của học viên hệ thống mokhoatrithuc.io.vn. Xem tên những thầy cô bạn được học.">
  <link rel="icon" href="iogo.png" type="image/png">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://mokhoatrithuc.io.vn/">
  <meta property="og:title" content="Sheet Học Tập">
  <meta property="og:description" content="Full combo luyện thi THPT XPS 2K8, IELTS, TOEIC, và nhiều kỹ năng khác. Đăng ký một lần, học trọn đời!">
  <meta property="og:image" content="logo.png">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="http://mokhoatrithuc.io.vn/">
  <meta property="twitter:title" content="Bảng Giá Khóa Học Siêu Rẻ 2025 - mokhoatrithuc.io.vn">
  <meta property="twitter:description" content="Full combo luyện thi THPT XPS 2K8, IELTS, TOEIC, và nhiều kỹ năng khác. Đăng ký một lần, học trọn đời!">
  <meta property="twitter:image" content="logo.png">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;900&display=swap" rel="stylesheet">

  <style>
    :root{ --nav-h: 48px; } /* thanh top mỏng hơn */
    html, body{ height:100%; margin:0; padding:0; overflow:hidden; background:#f5f7fb;}
    body{ font-family:'Be Vietnam Pro',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; padding-top:var(--nav-h); box-sizing:border-box; }

    /* khung chính */
    #main-content{ display:flex; flex-direction:column; height:100%; gap:.75rem; }
    #sheet-wrap{
      position:relative; flex:1 1 auto; min-height:0; overflow:hidden;
      border-radius:14px; background:#fff;
      border:1px solid #e8ebf0;
      box-shadow:0 10px 20px -12px rgba(0,0,0,.15), 0 4px 8px -8px rgba(0,0,0,.08);
    }
    #sheet-iframe{ width:100%; height:100%; border:0; transform-origin: top left; }

    /* overlay loading */
    #loading{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, rgba(248,250,253,.9), rgba(248,250,253,.6));
      backdrop-filter:saturate(120%) blur(2px);
      z-index:40;
    }
    .spinner{
      width:34px; height:34px; border-radius:999px; border:3px solid #dbe3f0; border-top-color:#2563eb;
      animation:spin .8s linear infinite;
    }
    html, body {
  /* Cho phép kéo ngang/dọc, KHÔNG cho pinch-zoom */
      touch-action: pan-x pan-y;
    }

    @keyframes spin{ to{ transform:rotate(360deg);} }

    /* nav bóng nhẹ */
    .nav-shadow{ box-shadow:0 6px 18px -12px rgba(0,0,0,.25), 0 2px 6px -4px rgba(0,0,0,.08); }

    /* Bong bóng zoom nằm dưới cụm nút */
    .zoom-bubble{
      position:absolute; top:110%; right:0; background:rgba(17,24,39,.92); color:#fff;
      padding:6px 10px; border-radius:10px; font-size:13px; line-height:1;
      box-shadow:0 10px 24px rgba(0,0,0,.25); z-index:60; white-space:nowrap;
    }
    .zoom-bubble::after{
      content:""; position:absolute; top:-6px; right:14px; width:12px; height:12px;
      background:rgba(17,24,39,.92); transform:rotate(45deg);
    }

    /* Mobile tối ưu */
    @media (max-width: 768px){
      :root{ --nav-h: 46px; }
      #sheet-iframe{ transform:scale(.45); width:222.22%; height:222.22%; }
      .zoom-btn{ padding:4px 9px !important; font-size:12px !important; }
      .buy-btn{ padding:6px 10px !important; font-size:13px !important; }
    }
  </style>
</head>
<body class="text-gray-800 selection:bg-blue-600/10 selection:text-blue-800">

  <!-- NAV -->
  <nav class="bg-white/90 backdrop-blur-md fixed top-0 left-0 right-0 z-50 nav-shadow" style="height:var(--nav-h);">
    <div class="mx-auto max-w-6xl h-full px-3 sm:px-5">
      <div class="h-full flex items-center justify-between">
        <!-- Logo -->
        <a class="flex items-center gap-2" href="/" title="Trang chủ">
          <img class="h-8 w-auto" src="logo.png" alt="Khoahocvip">
          <span class="hidden sm:block text-sm font-semibold text-gray-700">MOKHOATRITHUC</span>
        </a>

        <!-- Controls -->
        <div class="flex items-center gap-2 md:gap-3">
          <!-- Zoom group -->
          <div id="zoom-group" class="relative flex items-center gap-1">
            <button id="zoom-out" class="zoom-btn px-3 py-1.5 rounded-lg bg-blue border border-gray-200 shadow-sm hover:border-gray-300 hover:bg-gray-50 active:scale-[.98] transition text-gray-700" aria-label="Thu nhỏ (−)">−</button>
            <button id="zoom-in"  class="zoom-btn px-3 py-1.5 rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700 active:scale-[.98] transition" aria-label="Phóng to (+)">+</button>
            <button id="zoom-reset" class="zoom-btn px-3 py-1.5 rounded-lg bg-gray-700 text-white shadow hover:bg-gray-800 active:scale-[.98] transition" aria-label="Về 100%">Reset</button>
            <!-- Bong bóng -->
            <div id="zoom-hint" class="zoom-bubble hidden">THU NHỎ - PHÓNG TO Ở ĐÂY !</div>
          </div>

          <!-- CTA mua -->
          <a href="https://zalo.me/"
             class="buy-btn inline-flex items-center gap-2 rounded-xl bg-blue-600 text-white font-semibold py-2 px-3 md:px-4 shadow hover:shadow-md hover:bg-blue-700 active:scale-[.98] transition">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="hidden sm:inline">Mua khóa học</span><span class="sm:hidden">Mua</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main id="main-content" class="px-3 sm:px-5 pb-3 pt-0">
    <div id="sheet-wrap">
      <!-- overlay loading -->
      <div id="loading">
        <div class="flex flex-col items-center gap-3 text-gray-600">
          <div class="spinner"></div>
          <p class="text-sm">Đang tải trang tính…</p>
        </div>
      </div>

      <iframe id="sheet-iframe"
        src="https://docs.google.com/spreadsheets/d/1kwcF_6vDUL80fyvpmSMFedubfFJs5bIum5SvTHmf86Q/edit?usp=sharing"
        allowfullscreen
        title="Sheet Học Tập - mokhoatrithuc.io.vn/">
        Đang tải trang tính của bạn...
      </iframe>
    </div>
  </main>

  <script>
    // ========= Helpers =========
    const iframe = document.getElementById('sheet-iframe');
    const loading = document.getElementById('loading');
    const hint = document.getElementById('zoom-hint');

    // Ẩn overlay khi iframe load
    iframe.addEventListener('load', () => {
      loading.style.display = 'none';
    });

    // ========= Zoom =========
    let zoomLevel = Number(localStorage.getItem('sheetZoom') || '1');
    function applyZoom() {
      iframe.style.transform = `scale(${zoomLevel})`;
      iframe.style.width = (100 / zoomLevel) + '%';
      iframe.style.height = (100 / zoomLevel) + '%';
      localStorage.setItem('sheetZoom', String(zoomLevel));
    }
    function clampZoom(z){ return Math.min(2.0, Math.max(0.2, Math.round(z*10)/10)); }

    document.getElementById('zoom-in').onclick  = () => { zoomLevel = clampZoom(zoomLevel + 0.1); applyZoom(); };
    document.getElementById('zoom-out').onclick = () => { zoomLevel = clampZoom(zoomLevel - 0.1); applyZoom(); };
    document.getElementById('zoom-reset').onclick = () => { zoomLevel = 0.8; applyZoom(); };

    // Phím tắt: + / - / 0
    window.addEventListener('keydown', (e)=>{
      if (['INPUT','TEXTAREA'].includes((e.target.tagName||'').toUpperCase())) return;
      if (e.key === '+'){ e.preventDefault(); zoomLevel = clampZoom(zoomLevel + 0.1); applyZoom(); }
      if (e.key === '-'){ e.preventDefault(); zoomLevel = clampZoom(zoomLevel - 0.1); applyZoom(); }
      if (e.key === '0'){ e.preventDefault(); zoomLevel = 1; applyZoom(); }
    });

    // Áp dụng zoom ban đầu
    applyZoom();

    // ========= Bong bóng Zoom: 3 lần (5s bật / 5s tắt) =========
    let shownCount = 0;
    function showHintOnce(){
      if (shownCount >= 3) return;
      hint.classList.remove('hidden');
      setTimeout(()=>{
        hint.classList.add('hidden');
        shownCount++;
        if (shownCount < 3) setTimeout(showHintOnce, 5000);
      }, 5000);
    }
    window.addEventListener('load', ()=> setTimeout(showHintOnce, 350));
  </script>
  <script>
    // Chặn gesture của Safari iOS (non-standard nhưng cần thiết)
    window.addEventListener('gesturestart',  e => e.preventDefault(), {passive:false});
    window.addEventListener('gesturechange', e => e.preventDefault(), {passive:false});
    window.addEventListener('gestureend',    e => e.preventDefault(), {passive:false});
  
    // Phòng trường hợp một số trình duyệt vẫn cố pinch -> chặn khi có 2 ngón
    document.addEventListener('touchmove', (e) => {
      if (e.touches && e.touches.length > 1) e.preventDefault();
    }, {passive:false});
  </script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T3HC34BE89"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-T3HC34BE89');
  </script>
</body>
</html>

